<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>ESP32 Manual Input</title>
</head>
<body>

<h2>ğŸ“¡ Enviar datos al ESP32 (AWS IoT)</h2>

<label>Ranura</label>
<input type="number" id="ranura" value="1"><br><br>

<label>Voltaje (V)</label>
<input type="number" step="0.01" id="voltaje" value="4.20"><br><br>

<label>Corriente (A)</label>
<input type="number" step="0.001" id="corriente" value="0.150"><br><br>

<label>Temperatura (Â°C)</label>
<input type="number" id="temperatura" value="30"><br><br>

<button onclick="enviar()">ğŸ“¤ Enviar a ESP32</button>

<pre id="log"></pre>

<script>
const API_URL = "https://TU_API.execute-api.us-east-1.amazonaws.com/iot";

function log(m) {
  document.getElementById("log").textContent += m + "\n";
}

async function enviar() {

  const payload = {
    action: "publish",
    topic: "esp32/sub",
    message: {
      ranura: Number(document.getElementById("ranura").value),
      voltaje: Number(document.getElementById("voltaje").value),
      corriente_f: Number(document.getElementById("corriente").value),
      temperatura: Number(document.getElementById("temperatura").value)
    }
  };

  log("ğŸ“¦ Enviando:");
  log(JSON.stringify(payload.message, null, 2));

  try {
    const res = await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    const data = await res.json();
    log("âœ… Respuesta API:");
    log(JSON.stringify(data, null, 2));

  } catch (e) {
    log("âŒ Error: " + e.message);
  }
}
</script>

</body>
</html>
