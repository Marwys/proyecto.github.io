<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Control ESP32 â€“ Ranuras</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
<h2>ğŸ”‹ Control de Ranuras ESP32</h2>

<div class="panel">
  <h3>Ranura 1</h3>
  <button onclick="send({ranura:1, enable:true})">â–¶ Activar</button>
  <button onclick="send({ranura:1, enable:false})">â¹ Apagar</button>
  <button onclick="send({ranura:1, lock:true})">ğŸ”’ Bloquear</button>
  <button onclick="send({ranura:1, lock:false})">ğŸ”“ Desbloquear</button>
</div>

<div class="panel">
  <h3>Ranura 2</h3>
  <button onclick="send({ranura:2, enable:true})">â–¶ Activar</button>
  <button onclick="send({ranura:2, enable:false})">â¹ Apagar</button>
  <button onclick="send({ranura:2, lock:true})">ğŸ”’ Bloquear</button>
  <button onclick="send({ranura:2, lock:false})">ğŸ”“ Desbloquear</button>
</div>

<div class="panel emergency">
  <h3>ğŸš¨ Emergencia</h3>
  <button onclick="send({emergency:true})">APAGADO TOTAL</button>
</div>

<pre id="log"></pre>

<script>
const API_URL = "https://TU_API.execute-api.us-east-1.amazonaws.com/iot";

function log(msg) {
  const t = new Date().toLocaleTimeString();
  document.getElementById("log").textContent += `[${t}] ${msg}\n`;
}

async function send(message) {
  log("ğŸ“¤ Enviando: " + JSON.stringify(message));

  try {
    const res = await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        action: "publish",
        topic: "esp32/sub",
        message: message
      })
    });

    const data = await res.json();
    data.success ? log("âœ… OK") : log("âŒ Error");
  } catch (e) {
    log("âŒ " + e.message);
  }
}
</script>

<style>
body {
  font-family: Arial;
  background: #111;
  color: #eee;
  padding: 20px;
}
.panel {
  background: #222;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 8px;
}
.emergency {
  background: #5a0000;
}
button {
  margin: 5px;
  padding: 10px 16px;
  font-size: 14px;
  cursor: pointer;
}
#log {
  background: #000;
  padding: 10px;
  height: 200px;
  overflow-y: auto;
}
</style>
</body>
</html>
